<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/frontend/public/css/common.css">
  <script src="https://kit.fontawesome.com/8293371a0e.js" crossorigin="anonymous"></script>
  <title>Shopping Project</title>
</head>
<body>
  <div class="wrapper">
    <header>logo</header>
    <section>
      <h2>Sign up for account</h2>
      <form id="user_info" action="javascript:submitSignUp()">
        <input type="text" id="user_id"/><br/>  
        <input type="password" id="user_password"/>
        <input type="checkbox" id="seePw">
        <label for="seePw"></label><br/>
        <input type="password" id="password_confirm"/>
        <input type="checkbox" id="seePw2">
        <label for="seePw2"></label>
        <button type="button" onclick="confirmPw()">Confirm</button><br/>
        <input type="email" id="user_email"/>
        <button type="button" onclick="sendMail()" id="send_mail_btn">메일 전송</button><br/>
        <input type="number" id="confirm_num" min="111111" max="999999" placeholder="인증번호 6자리를 입력하세요">
        <span id="timer"></span>
        <button type="button" id="confirm_num_btn" onclick="confirmMail()">인증번호 확인</button><br/>
        <input type="text" id="user_name"/><br/>
        <button type="submit" value="가입하기">Sign Up</button><!-- button으로 해도 되고 input type="submit" 으로 해도 됨-->
      </form>
    </section>
    <footer>
      COPYRIGHT ALL RIGHTS RESERVED
    </footer>
  </div>
</body>

<script>
//모든 button 한번씩 눌러야 signup button 눌렀을때 동작하게
// count > 3
// let count = 0;

  const confirmPw = () => {
    let user_password = document.getElementById("user_password")
    let password_confirm = document.getElementById("password_confirm")
    let user_email = document.getElementById("user_email")
    if( user_password.value == password_confirm.value){
      // 패스워드 확인 input hide
      // button도 hide (둘을 묶어서 하는게 좋을듯 )
      //user_email show + focus()
    }else{
      alert('비밀번호가 일치하지 않습니다.')//나중에는 창 만들어야지
      user_password.value = '';
      user_password.focus();
      password_confirm.value = '';
    }

  }

  const sendMail = () => {
    let user_email = document.getElementById("user_email").value
    console.log(user_email)

    fetch('http://localhost:3000/api/AuthEmail').then().then()
    // user_email 메일전송

    //setTimeout() 일정시간이 지난 후 특정 코드를 딱 1번 실행
    setTimeout(()=>{

    },180000)

    getElementById("send_mail_btn").innerHTML = "메일 재전송";
  }

  const confirmMail = () => {
    let confirm_num = document.getElementById("confirm_num").value
    //let mailing_num = fetch() 에서 받아야 함 ?!

    setTimeout(()=>{

      if( confirm_num == /* 전송된 6자리 숫자값 */){
      alert('인증완료');
      //전송버튼 어둡게 되고 안눌리게
      getElementById("confirm_num_btn").innerHTML = "인증완료"
      //확인버튼 어둡게 되고 안눌리게
      }else{
        alert('❌❌❌❌❌');
        confirm_num = '';
        confirm_num.focus();
      }

   
  
    },180000)
  }
    

  
    

  const submitSignUp = () => {
    let user_id = document.getElementById("user_id")
    let user_password = document.getElementById("user_password")
    let user_email = document.getElementById("user_email")
    let user_name = document.getElementById("user_name")
    const objectInfo = {
      "user_id" : user_id.value,
      "user_password" : user_password.value,
      "user_email" : user_email.value,
      "user_name" : user_name
    }
    // console.log(user_id.value)

    
    // console.log(objectInfo)

    //여기서 fetching?? post 방식

  }

  let time = 180;
  let min = "";//분
  let sec = "";//초
  setInterval(function(){
    min = parseInt( time / 60);//몫을 계산
    sec = time%60; //나머지를 계산
    
    document.getElementById("demo").innerHTML = `${min}분 ${sec}초` ;
    time--

    if(time<0){
      clearInterval(x); // setInterval 실행을 끝냄
      document.getElementById("demo").innerHTML = "시간초과";
    }    
  },1000);
</script>
</html>